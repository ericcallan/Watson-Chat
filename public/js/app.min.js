!function e(t,n,r){function a(o,s){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(i)return i(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){var n=t[o][1][e];return a(n?n:e)},c,c.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){"use strict";var r,a=[],i=[],o=null,s=!1,u=0,l=null,c=null,d=null,f=null,g=null,p=(document.getElementById("output"),{query:function(e,t){var n=$('[name="_token"]').val();$.ajax({method:"POST",url:"/",data:{search:e,_token:n},success:function(e){return t(e)},error:function(e){console.log(e)}})},playSound:function(e){function t(){requestAnimationFrame(t),i.getByteFrequencyData(o);for(var e=0,n=o.length,a=0;n>a;a++)e+=o[a];r=e/n}var n=new Audio("../generated/t2s/"+e),a=g.createMediaElementSource(n),i=g.createAnalyser();a.connect(i),a.connect(g.destination);var o=new Uint8Array(i.frequencyBinCount);n.play(),t()},doText:function(e){var t="",n="";if(e){$("img").removeClass("active");var t='<li class="watson watsonRequest"><p>'+e.replace(/['"]+/g,"")+"</p></li>";$("ul").append(t),$("ul").animate({scrollTop:$("ul")[0].scrollHeight},2e3),$("li").addClass("active"),$("#search").val("").focus(),p.query(e,function(e){var t=JSON.parse(e).response;$.each(t,function(e,t){n+=t+"<br/>"}),p.playSound(JSON.parse(e).audio),n="undefined"!=typeof JSON.parse(e).image?'<li style="max-height:13rem;height:13rem;" class="watson watsonResponse"><p>'+n+" <img style='padding: 1rem;height: 8rem; position: absolute; right: 0; bottom: rem;top: 3rem;' src='"+JSON.parse(e).image+"' /></p></li>":'<li class="watson watsonResponse"><p>'+n+"</p></li>",$("ul").append(n),$("ul").animate({scrollTop:$("ul")[0].scrollHeight},2e3),$("li").addClass("active")})}}}),v={init:function(){navigator.getUserMedia||(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),navigator.getUserMedia?navigator.getUserMedia({audio:!0},this.success,function(e){alert("Error capturing audio.")}):alert("getUserMedia not supported in this browser.")},success:function(e){f=window.AudioContext||window.webkitAudioContext,g=new f,d=g.sampleRate,l=g.createGain(),c=g.createMediaStreamSource(e),c.connect(l);var t=2048;o=g.createScriptProcessor(t,2,2),o.onaudioprocess=function(e){var n=e.inputBuffer.getChannelData(0),r=e.inputBuffer.getChannelData(1);a.push(new Float32Array(n)),i.push(new Float32Array(r)),u+=t},l.connect(o),o.connect(g.destination)},mergeBuffers:function(e,t){for(var n=new Float32Array(t),r=0,a=e.length,i=0;a>i;i++){var o=e[i];n.set(o,r),r+=o.length}return n},interleave:function(e,t){for(var n=e.length+t.length,r=new Float32Array(n),a=0,i=0;n>i;)r[i++]=e[a],r[i++]=t[a],a++;return r},writeUTFBytes:function(e,t,n){for(var r=n.length,a=0;r>a;a++)e.setUint8(t+a,n.charCodeAt(a))}};$(document).ready(function(e){v.init(),e("#record").on("click",function(t){if(s===!1)e(".circle").addClass("recording"),s=!0,a.length=i.length=0,u=0;else{var n=function(t){var n=new FileReader;n.onload=function(t){var n={};n.fname="test.wav",n.data=t.target.result,e.ajax({type:"POST",url:"/uploads",data:n,dataType:"text"}).done(function(e){p.doText(e)})},n.readAsDataURL(t)};e(".circle").removeClass("recording"),s=!1;var r=v.mergeBuffers(a,u),o=v.mergeBuffers(i,u),l=v.interleave(r,o),c=new ArrayBuffer(44+2*l.length),f=new DataView(c);v.writeUTFBytes(f,0,"RIFF"),f.setUint32(4,44+2*l.length,!0),v.writeUTFBytes(f,8,"WAVE"),v.writeUTFBytes(f,12,"fmt "),f.setUint32(16,16,!0),f.setUint16(20,1,!0),f.setUint16(22,2,!0),f.setUint32(24,d,!0),f.setUint32(28,4*d,!0),f.setUint16(32,4,!0),f.setUint16(34,16,!0),v.writeUTFBytes(f,36,"data"),f.setUint32(40,2*l.length,!0);for(var g=l.length,w=44,m=1,h=0;g>h;h++)f.setInt16(w,l[h]*(32767*m),!0),w+=2;var U=new Blob([f],{type:"audio/wav"});(window.URL||window.webkitURL).createObjectURL(U),new FormData;n(U)}}),e("form").on("submit",function(t){t.preventDefault();var n=e("#search").val();p.doText(n)})})},{}]},{},[1]);